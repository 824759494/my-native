<?php
class CouchController extends CommonController{

	/* 申请列表字典 */
	private static $aclistDict=array(
		'TREATED'	=>0,//待处理的沙发列表
		'AGREED'	=>1,//已经同意的
		'OPPOSED'	=>2,//拒绝的
		'ALL'		=>3,//所有的list
		'SELF'		=>4,//自己申请的沙发列表
		'POSITIVE'	=>5,//正面评价
		'NEGATIVE'	=>6,//负面评价
	);
	
	private static $couchApplyStatus=array(
		'TREATED'	 =>0,//未接待
		'AGREED' 	 =>1,//接待
		'OPPOSED'	 =>2,//拒绝
	);
	/* 
	*申请沙发
	*@aUid申请者uid
	*@cUid沙发主uid
	*@return JSON数据
	*{
	*	'status':操作状态
	* 1100 或者0 OK
	* 1101 NOTOVER_ERROR
	* 1102 UPDATE_ERROR
	* 1103 ADD_ERROR
	* 1104 NOTAGREED
	* 1105 NOTCHECKIN
	* 1106 DATAEMPTY	
	*} 
	*/
	public function applyCouch($aUid,$cUid);
	
	/* 
	*获取关于uid对应对象的沙发申请列表（包含他申请的沙发与申请他沙发）
	*@uid 获取用户的uid
	*@start 列表分页加载时开始索引
	*@pageSize 分页加载每次加载数量
	*@type 获取沙发申请列表类型	：
	*	'TREATED'	=>0,//待处理的沙发列表
	*	'AGREED'	=>1,//已经同意的
	*	'OPPOSED'	=>2,//拒绝的
	*	'ALL'		=>3,//所有的list
	*	'SELF'		=>4,//自己申请的沙发列表
	*return  JSON数据 status:
	* 1 FAIL SQL操作失败
	* 2 NORECORD 没有记录
	* 1100 OK 成功
	*/
	public function getApplyCouchList($uid,$start=0,$type='ALL',$pageSize=20);
	/* 
	*处理沙发申请
	*id 沙发申请id
	*admit 处理状态参数 1接受 2拒绝
	*return JSON
	*status:
	*'FAIL'      =>1,//sql操作失败
	*'NORECORD'  =>2,//没有记录
	*'ILLOPT'	=>3,//sql操作非法
	*'NOTLOGIN'	=>4,//未登录
	*'OK'=>1100,
	*'NOTOVER_ERROR'=>1101,//未过期申请
	*'UPDATE_ERROR'=>1102,//更新过期申请出错
	*'ADD_ERROR'=>1103,//添加沙发申请数据操作失败
	*'NOTAGREED'=>1104,//没有同意入住
	*'NOTCHECKIN'=>1105,//没有入住
	*'DATAEMPTY'=>1106,//插入数据为空
	*'PUTEDIMPRESS'=>1107,//已经发生印象
	*'OVERTIME'=>108,//申请过期
	*/
	public function couchReqstHandle($id,$admit);
	
	/* 
	*反馈沙发印象，评价对沙发主的感受与沙发主居住环境
	*return JSON
	*status:
	*$_POST['id'];//沙发申请id
	*$_POST['touid'];//要评价的用户uid
	*$_POST['content'];//评价内容
	*$_POST['type'];//评价类型0:负面,1:正面
	*'FAIL'      =>1,//sql操作失败
	*'NORECORD'  =>2,//没有记录
	*'ILLOPT'	=>3,//sql操作非法
	*'NOTLOGIN'	=>4,//未登录
	*'OK'=>1100,
	*'NOTOVER_ERROR'=>1101,//未过期申请
	*'UPDATE_ERROR'=>1102,//更新过期申请出错
	*'ADD_ERROR'=>1103,//添加沙发申请数据操作失败
	*'NOTAGREED'=>1104,//没有同意入住
	*'NOTCHECKIN'=>1105,//没有入住
	*'DATAEMPTY'=>1106,//插入数据为空
	*'PUTEDIMPRESS'=>1107,//已经发生印象
	*'OVERTIME'=>108,//申请过期
	*/
	public function putImpress();
	/* 
	*添加图片
	*使用uploadify插件上传图片
	*@return：
	*status=0时{'status'=>0,'imgs'=>[返回的上传图片数据库信息数组 注释（3）]}，成功
	*status=1 未登录 status=2 上传操作失败 status=3 数据库操作错误 
	*{'status'=>1、2或者3,'error'=>错误消息}
	*/
	public  function addSofaImg();
	
	/* 
	*删除图片
	*@albumid 相册id
	*@return：
	*status=0时{'status'=>0}，成功
	*status=1 数据库没有图片 status=2  数据库操作错误  status=3图片删除出错 status=4 掉线
	*/
	public function reomveImage($imageid);
	
	
	//添加沙发
	/* 
	*$lang 版本 （ch 中文版 en英文版）
	*POST参数:
	*{
	*	'name':沙发名称（现在不使用）,
	*	'status':沙发状态 接待或者不接待沙发客 0-不接待 1-接待,
	*	'receive_sex':沙主接待沙发客性别要求 0-女生 1-男生 2-不限,
	*	'receive_num':沙主一次能够接受的沙发客人数取值[0-7], 1-7表示接受1-7人 0表示不限人数,
	*	'countryid':沙主所在国家id,
	*	'provinceid':沙主所在省份id,
	*	'cityid':沙主所在城市id,
	*	'toilet':沙发主家中卫生间状况 0-独立卫生间 1-共享卫生间,
	*	'sleep_bed':沙发主提供睡觉场地 0-共享床铺 1-单独床铺 2-沙发 3-地铺,
	*	'condition_set':住宿调到集合使用逗号（,英文逗号）隔开，A-wifi B-空调 C-停车位 D-禁烟 E-洗衣机 F-淋浴 G-宠物 H-厨房,
	*	'lng':经度,
	*	'lat':维度,
	*	'imgs':{
	*		'num':照片数量,
	*		'pics':照片id数组
	*	}
	*}
	*上述参数当没有发生改变时可以填写成null，或者不填写（推荐填写null）
	*return:
	*{
	*	'status':0-成功 1-未登录 2-添加沙发信息失败,
	*}
	*/
	public function addSofa($lang='ch');
	
	//更新沙发
	/* 
	*$sofaid 沙发id（现阶段每位用户只发布一个沙发信息，所以这里取值为1）
	*$status 沙发主接待沙发客状态 0-不接待 1-接待
	*return:
	*{
	*	'status':更新操作状态 true 成功 false失败 null 数据库操作错误
	*}
	*/
	public function updateSofaStatus($sofaid,$status);
	
	//获取沙发信息
	/* 
	*$account 用户账号 用户信息中的account字段
	*$sofaid沙发id（现阶段每位用户只发布一个沙发信息，所以这里取值为1）
	*return :
	*{
	*	'uid':用户uid,
	*	'account':用户账号 ,
	*	'verify_status':用户账号验证状态。是否通过邮箱、手机与身份证信息验证。是否通过邮箱、手机与身份证信息验证 (验证状态是可以叠加的，
	*	以二进制为基础的4位数字。 0未验证，第一位邮箱验证（1），第二位手机验证（2）,第三位身份证号码（4），第四位身份证照片（8））,
	*	'sex':用户性别 0-女生 1-男生,
	*	'sfdmitnum':已经接待过沙发客次数,
	*	'sfid':沙发id 现在阶段只取值1,
	*	'sfname':沙发名称 现在阶段不使用,
	*	'sfstatus':沙发主接待沙发客状态 0-不接待 1-接待,
	*	'receive_sex':沙发主愿意接待的沙发客性别要求 0-女生 1-男生 2-不限,
	*	'receive_num':沙主一次能够接受的沙发客人数取值[0-7], 1-7表示接受1-7人 0表示不限人数,
	*	'countryid':国家id,
	*	'provinceid':省份id,
	*	'cityid':城市id,
	*	'toilet':沙发主家中卫生间状况 0-独立卫生间 1-共享卫生间,
	*	'sleep_bed':沙发主提供睡觉场地 0-共享床铺 1-单独床铺 2-沙发 3-地铺,
	*	'condition_set':住宿调到集合使用逗号（,英文逗号）隔开，A-wifi B-空调 C-停车位 D-禁烟 E-洗衣机 F-淋浴 G-宠物 H-厨房,
	*	'lng':经度,
	*	'lat':维度,
	*	,'sofapraise':沙发点赞人数（现阶段没使用）,
	*	'payattention':粉丝数,
	*	'headImg':{
	*		'path':路径,'name':图片名称,"type":头像类型 0默认图像（当type=0时没有path与name字段，img_id为默认图片编号。根据编号选取图片） 1自定义,
	*		'img_id'：图片id,'owernid':用户id
	*	},
	*	'imgs':{'num':图片数量,'pics':图片数组 数组元素参考注释（1）}
	*}
	*/
	public function getSofa($account,$sofaid=1);
	
	//获取沙发照片
	/* 
	*$id 
	*return:
	*{
	*	'status':true-成功 false-失败,
	*   'data':图片数组 数组元素参考注释（2）
	*}
	*/
	public function getSofaImg($id);
}
/**************************************************************************************************************************************************
注释
（1）
	{
		'id':图片id,
		'name':图片名称,
		'path':图片存储路径,
		'owernid':用户id
	}
（2）
	{
	  `owern_id`:用户id,
	  `id`:图片id,
	  `savename`  :'保存的图片名称',
	  `savepath`  :'保存目录',
	  `create_time` : '上传时间',
	}
（3） {
		'owern_id':图片拥有者的uid
		'albumid':相册名id（这里不需要理会）
		'catname':相册名称（不需要理会）
		'savename':图片名称
		'savepath':图片存储路径
		'create_time':创建时间（unix时间戳）
		'thumbnames':缩略图名称集合（不需要理会）
		'id':图片存储id
	}
***********************************************************************************************************************************************/
 
?>